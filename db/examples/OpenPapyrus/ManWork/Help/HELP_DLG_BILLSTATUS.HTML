<HTML>
<HEAD>
<TITLE>HELP_DLG_BILLSTATUS.HTML</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="style.css" /></HEAD>

<BODY>
<P>

<BR><H3>Диалог редактирования статуса документов</H3>

<BR><IMG SRC=dlg-billstatus.png><BR><I>Диалог редактирования статуса документов</I><BR>

<BR>Вид диалога редактирования записи статуса приведен на рис..
Далее описываются управляющие элементы этого диалога:

<BR><TR><TD><DL>
	<DD><B>Наименование</B>
	Уникальное в пределах справочника наименование статуса.

<BR>	<DD><B>Символ</B>
	Это поле либо пустое либо содержит уникальный символ статуса.

<BR>	<DD><B>ИД</B>
	Справочное поле, отображающее идентификатор статуса.

<BR>	<DD><B>Ранг</B>
	Ранг статуса определяет его положение среди остальных записей справочника.
	Наиболее важным использованием этого атрибута является ограничение
	на изменение статуса документа на статус с меньшим рангом.

<BR>	<DD><B><I>Документы нельзя модифицировать</I></B>
	Документу, имеющие этот статус нельзя модифицировать.
	
	<I>
		Существует технологическое исключение для этого флага: при списании кассовой сессии система
		пытается скорректировать сумму одного из документов таким образом, чтобы итоговое значение сумм
		документов списания точно совпадало с суммой кассовой сессии. Для этого один из документов
		может быть модифицирован сразу вслед за проведением. На эту модификацию ограничение 
		статуса не распространяется.
	</I>	

<BR>	<DD><B><I>Документы нельзя удалять</I></B>
	Документы с этим статусом нельзя удалять.

<BR>	<DD><B><I>Документы нельзя передавать в другой раздел</I></B>
	При попытке передачи в другой раздел документа со статусом, имеющим
	этот признак, система выдаст сообщение о том, что данных документ
	не передан.

<BR>	Назначение этого флага - запретить передачу документов, которые
	еще не готовы окончательно.

<BR>	<DD><B><I>Связанные документы нельзя изменять</I></B>
	Этот флаг запрещает создание, изменение и удаление документов,
	связанных с документом, имеющим данный статус.

<BR>	Под связанными документами подразумеваются как документы,
	имеющие прямую ссылку на данный документ (оплаты, связанные возвраты и т.д.),
	так и имеющие членство в платежном или операционном пуле данного документа.

<BR>	<DD><B><I>Нельзя менять на статус с меньшим рангом</I></B>
	Статус документов не может быть изменен на статус, имеющий ранг, значение
	которого меньше ранга данного статуса.

<BR>	Смысл этого флага - обеспечить необратимость изменения статусов во
	избежании обхода других ограничений статуса.

<BR>	Для примера приведем следующую характерную ситуацию:
	<TR><TD><UL>
		<LI> Пользователь пытается изменить документ
		<LI> Система сообщает в ответ на это, что статус не допускает изменение документа
		<LI> Пользователь меняет статус этого документа на тот, который допускает изменение,
		и изменяет документ
		<LI> Наконец, пользователь, возвращает статус документа в исходное состояние.
	</UL>

<BR>	Для исключения такого и аналогичных сценарием и необходим обсуждаемый признак.
	Он позволяет настроить систему статусов документов таким образом, чтобы
	некоторые изменения статусов были необратимыми.

<BR>	<DD><B><I>Не проводить проводки по документу</I></B>
	Этот флаг блокирует формирование бухгалтерских проводок по документу.

<BR>	Здесь необходимы пояснения относительно механизма работы.
	Опция завязана на специальный признак документа <I>Без бухгалтерских проводок</I>.
	При изменении статуса документа система идентифицирует факт изменения флага
	<I>Не проводить проводки по документу</I> между старым и новым статусом.
	Если этот признак был и остался либо не был и не появился, то никаких действий
	в связи с ним не осуществляется (независимо от того, установлен у документа
	флаг <I>Без бухгалтерских проводок</I> или нет).

<BR>	Если между старым и новым статусом состояние рассматриваемого флага изменилось,
	то программа сравнит требование флага с состоянием документа и установит, снимет,
	либо оставит как есть признак документа <I>Без бухгалтерских проводок</I>.

<BR>	Важно заметить, что обсуждаемый флаг появился на много позже, чем соответствующий
	признак документа. В специальных случаях пользователи практикуют флаг <I>Без бухгалтерских проводок</I>
	документа. Приведенные пояснения призваны четко обозначить взаимосвязь этих
	признаков для того, чтобы избежать неожиданностей.

<BR>	Приведем гипотетический сценарий (в хронологическом порядке), чреватый конфликтом:
	<TR><TD><UL>
		<LI> Документ имеет статус без флага <I>Не проводить проводки по документу</I>
		и в нем не установлен признак <I>Без бухгалтерских проводок</I>: документ имеет
		бухгалтерские проводки.
		<LI> Пользователь $A$ устанавливает в документе признак <I>Без бухгалтерских проводок</I>:
		документ теряет бухгалтерские проводки.
		<LI> Пользователь $B$ меняет статус документа на тот, который блокирует проводки по документу:
		документ остается без бухгалтерских проводок.
		<LI> Пользователь $C$ меняет статус документа на тот, который не блокирует проводки по документу:
		для документа формируются бухгалтерские проводки.
	</UL>
	В описанной ситуации пользователи $B$ и $C$ сделали свою работу и результат вполне
	адекватен их ожиданиям. Однако, для пользователя $A$ состояние базы данных на момент
	завершения сценария совершенно неожиданно, поскольку он рассчитывал, что документ не имеет
	бухгалтерских проводок.

<BR>	Несмотря на то, что ручное использование флага <I>Без бухгалтерских проводок</I>
	практикуется редко, следует помнить о потенциальной опасности приведенного сценария.

<BR>	<DD><B><I>Не учитывать как оплату</I></B>
	Действие флага распространяется на документы, относящиеся к типам:

<BR>	<TR><TD><UL>
		<LI><Q>Оплата</Q>.
		<LI><Q>Возврат товара</Q>.
		<LI><Q>Начисление ренты</Q> при установленном признаке
		<I>Считать отрицательной оплатой</I>.
	</UL>

<BR>	Если документ указанных типов получает статус с рассматриваемым флагом,
	то он не будет учитываться как оплата по документу, к которому привязан.

<BR>	Смысл использования флага заключается в том, чтобы до некоторых пор (до
	момента присвоения статуса без такого флага) документ считался бы не учтенным.
	К примеру, в период времени между отправкой платежа и подтверждением его
	получения кредитором. Либо, в отрезок времени между выпиской доверенности на
	получения платежа агентов у дебитора и сдачей агентом полученных денег в
	кассу предприятия.

<BR>	<I>
		Будьте внимательны: изменение этого флага у статуса, с которым уже
		связаны какие-либо документы может привести к серьезным нарушениям в
		учете дебиторской и кредиторской задолженности.
	</I>
	<DD><B>Флаги обязательных к заполнению атрибутов документа</B>

<BR>	Эти флаги определяют атрибуты, которые не могут быть пустыми
	для документов, имеющих данный статус.

<BR>	<TR><TD><DL>
		<DD><B><I>Агент</I></B> С документом, имеющим этот статус, должен быть обязательно связан агент.
		<DD><B><I>Плательщик</I></B> Документ должен содержать не пустой атрибут <Q>Плательщик</Q>.
		<DD><B><I>Адрес доставки</I></B> В параметрах фрахта документа должно быть обязательно инициализировано поле <Q>Адрес доставки</Q>.
		<DD><B><I>Порт загрузки</I></B> Порт загрузки во фрахте документа должен быть не пустым.
		<DD><B><I>Порт разгрузки</I></B> Порт разгрузки во фрахте документа должен быть не пустым.
		<DD><B><I>Дата отправления</I></B> Фрахт должен содержать дату отправления.
		<DD><B><I>Дата прибытия</I></B> Фрахт должен содержать дату прибытия на конечный пункт.
		<DD><B><I>Транспортное средство</I></B> Во фрахте документа должно быть определено транспортное средство.
		<DD><B><I>Стоимость фрахта</I></B> Фрахт должен содержать значение стоимости транспортировки больше нуля.
		<DD><B><I>Капитан (водитель) транспорта</I></B> Во фрахте документа необходимо заполнить поле капитана (водителя) транспортного средства.
		<DD><B><I>Транспортный брокер</I></B> Необходимо указать транспортного брокера во фрахте документа.
		<DD><B><I>Контрагент по документу</I></B>
		Флаг ограничивает возможность сохранения документа, если для вида
		операции, которому принадлежит документ определена основная таблица
		статей, но соответствующая статья (контрагент) в документе не выбрана.
		<DD><B><I>Дополнительный объект</I></B>
		Если вид операции, к которой относится документ, определяет таблицу статей дополнительного объекта документа, 
		то такой документ, имеющий статус с данным флагом, не может содержать пустое поле дополнительного объекта.
		<DD><B><I>Дата исполнения</I></B>
		Флаг предписывает каждому документу с таким статусом иметь не пустую дату исполнения.
		<DD><B><I>Номер документа</I></B>
		Документ, имеющий пустой номер, не может быть сохранен с данным статусом.
	</DL>

<BR>	Флаги, относящиеся к фрахту:
	<TR><TD><UL>
		<LI><I>Адрес доставки</I>,
		<LI><I>Порт загрузки</I>,
		<LI><I>Порт разгрузки</I>,
		<LI><I>Дата отправления</I>,
		<LI><I>Дата прибытия</I>,
		<LI><I>Транспортное средство</I>,
		<LI><I>Стоимость фрахта</I>,
		<LI><I>Капитан (водитель) транспорта</I>,
		<LI><I>Транспортный брокер</I>
	</UL>
	действуют на документы только с теми видами операций, у которых задан флаг <I>Ввод информации по фрахту</I>.
	Подробно о вводе параметров фрахта документа  см. стр..

<BR>	<DD><B><U>Счетчик</U></B>
	В этом комбо-боксе может быть выбран счетчик операций. Целью такого
	выбора является изменение номера документа при присвоении ему
	данного статуса.

<BR>	Важно иметь в виду следующие правила, по которым используется этот
	счетчик при назначении номера документу:
	<TR><TD><UL>
		<LI> Если статус со счетчиком присваивается документу при
		его создании (определен в виде операций как статус нового документа),
		то используется именно этот счетчик, а не тот, который указан в
		виде операции.

<BR>		<LI> При изменении статуса номер документа меняется только в том
		случае, если либо новый статус отличается от старого, либо счетчик
		нового статуса отличается от счетчика предыдущего статуса или от
		счетчика, указанного в виде операции, которой принадлежит документ.

<BR>		<LI> Если, при изменении статуса, старый статус имел свой счетчик, а
		новый не имеет такового, то номер документа не меняется.

<BR>		<LI> При изменении самого статуса таким образом, что в нем меняется счетчик,
		никаких изменений в существующих документах, имеющих этот статус, не происходит.
	</UL>

<BR>	<DD><B><U>Допустимый вид операции</U></B>
	Вы можете ограничить использование некоторого статуса только документами,
	относящимися к одной или нескольким видам операций. Для этого в рассматриваемом
	комбо-боксе выберите либо обыкновенный вид операции, либо обобщенную операцию,
	определяющую набор обыкновенных видов, для которых возможно присвоение этого статуса.

<BR>	<I>
		Будьте внимательны: существует возможность коллизии между статусом новых
		документов, установленным в записи вида операции и набором допустимых операций
		в записи самого статуса (то, что мы сейчас обсуждаем).

<BR>		Если статус новых документов в виде операции содержит ограничение на допустимые
		виды операций, в которое не входит этот вид операции, то будет невозможно
		создать новый документ такого вида. При этом будет выдано сообщение об ошибке:
		<Q>Статус документа 'наименование-статуса', определенный для новых документов, не разрешено устанавливать для этого вида операции</Q>.
	</I>
</DL>


</BODY>
</HTML>
